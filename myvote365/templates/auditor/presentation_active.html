<!DOCTYPE html>
{% load staticfiles %}
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>[PLAY] {{ title }} –– {{ short_id_num }} | myVote365</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/presentation_active.css' %}">
    <link rel="shortcut icon" href="{% static 'favicon/ico_play.png' %}" type="image/x-icon">
    <script src="{% static 'javascript/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'fontawesome-pro-5.10.2-web/js/all.js' %}"></script>
    <script>

        let slide_no = {
            'cur': 1,
            'min': 1,
            'max': {{ count_slides }},
        };

        let is_full_screen = false;

        $(function(){

            // slides control
            // by keybord arrows
            $(document).keydown(function (e) {
                console.log(e.key);
                switch (e.key) {
                    // next slide
                    case 'ArrowUp':
                    case 'ArrowRight':
                        nextSlide();
                        break;
                    // prev slide
                    case 'ArrowDown':
                    case 'ArrowLeft':
                        prevSlide();
                        break;
                    default:
                        break
                }
            });
            // by dom element
            $('#controls-right').click(function(){ nextSlide(); });
            $('#controls-left').click(function(){ prevSlide(); });

            $('#controls-full-screen-toggle').click(function(){ toggleFulscreen(); })

        }); // jQ END

        function nextSlide(){

            if( parseInt(slide_no.cur) + 1 <= parseInt(slide_no.max)){
                slide_no.cur = parseInt(slide_no.cur) + 1
            }

            show_slide_numbers()
        }

        function prevSlide(){

            if( parseInt(slide_no.cur) - 1 >= parseInt(slide_no.min)){
                slide_no.cur = parseInt(slide_no.cur) - 1
            }

            show_slide_numbers()
        }

        function show_slide_numbers(){

            $('#slide-no-all').text(slide_no.max);
            $('#slide-no-current').text(slide_no.cur);

        }

        function toggleFulscreen(){

            if( is_full_screen ){
                is_full_screen = false;
                closeFullscreen();
                $('#controls-full-screen-toggle > .ico').removeClass('fa-compress-wide');
                $('#controls-full-screen-toggle > .ico').addClass('fa-expand-wide');
            }else{
                is_full_screen = true;
                openFullscreen();
                $('#controls-full-screen-toggle > .ico').removeClass('fa-expand-wide');
                $('#controls-full-screen-toggle > .ico').addClass('fa-compress-wide');
            }

        }

        var elem = document.documentElement;

        /* View in fullscreen */
        function openFullscreen() {
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) { /* Firefox */
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) { /* IE/Edge */
                elem.msRequestFullscreen();
            }
        }

        /* Close fullscreen */
        function closeFullscreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.mozCancelFullScreen) { /* Firefox */
                document.mozCancelFullScreen();
            } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE/Edge */
                document.msExitFullscreen();
            }
        }

    </script>
</head>
<body>

    <main>{{ short_id_num }}</main>

    <aside>

        <p>Zeskanuj ten kod</p>
        <img src="/media/qr-codes/{{short_id_num}}.svg" alt="{{ short_id_num }} qr code">
        <p>lub wejdź na</p>
        <h2>myVote365.com</h2>
        <p>i wpisz</p>
        <h1>{{ short_id_num }}</h1>

    </aside>

    <footer>

        <article id="viewers">
            <span class="viewers_ico">
                <i class="ico far fa-users"></i>
            </span>
            <span class="viewers_count">12</span>
        </article>

        <article id="autor">
            Prezentacja stworzona przez: {{ name }}
        </article>

        <article id="controls">
            <div id="controls-right">
                <i class="ico far fa-chevron-right"></i>
            </div>
            <div id="controls-slide-no">
                <div id="slide-no-current">1</div>
                <div id="controls-slide-no-separator">/</div>
                <div id="slide-no-all">{{ count_slides }}</div>
            </div>
            <div id="controls-left">
                <i class="ico far fa-chevron-left"></i>
            </div>
            <div id="controls-full-screen-toggle">
                <i class="ico far fa-expand-wide"></i>
            </div>
        </article>

    </footer>

</body>
</html>